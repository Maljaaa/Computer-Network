# 01. 프로토콜의 이해
* 프로토콜 : 네트워크에 연결된 시스템이 통신하기 위한 일련의 규칙
* 모듈화 : 프로토콜 설계 과정

## 1. 계층적 모듈 구조
### 모듈화
[ 장점 ]
* 함수별로 특정 기능을 독립적으로 수행하도록 함 -> 각 함수가 개별적으로 설계되고 구현됨
* 함수 사이의 인터페이스는 함수의 매개변수에 의해서만 이루어지므로 전체 시스템을 이해하기 훨씬 쉬움
* 각 함수의 역할이 매개변수로 추상화되므로 내부 구조르 ㄹ이해하지 않고도 함수들을 이해할 수 있고, 전체 시스템도 쉽게 이해 가능

## 2. 프로토콜 설계 시 고려 사항
### 주소 표현
* 여러 호스트가 연결된 환경에서 특정 호스트끼리 통신하려면 상대방을 구분할 수 있는 방법 필요
* 일대일(1 : 1) 통신 : ex) 전화
* 일대다(1 : n) 통신 : ex) 그룹핑x - 브로드캐스팅(방송), 그룹핑o - 멀티캐스팅(그룹 톡, 온라인 화상 회의)

### 오류 제어
* 오류 제어(Error Control) : 네트워크에서 데이터 송수신 과정에서 발생하는 오류 문제를 해결
* 데이터 변형 오류 : 데이터가 깨져서 도착
* 데이터 분실 오류 : 데이터가 도착하지 못함

![image](https://user-images.githubusercontent.com/61977260/194747730-e549ffa3-91b1-4795-b092-5d6d3d1eafca.png)
> (a) : 정상
>
> (b) : 데이터 분실 오류
>
> (c) : 데이터 변형 오류

* (b)의 원인 : 버퍼가 가득차서 수신 데이터가 discard 될 때
* 전송 오류 해결 방법 : 송신 호스트가 원래 데이터를 재전송

### 흐름 제어
* 송수신 호스트 사이에 데이터 전송/처리 속도 차이 존재 -> 버퍼 공간이 확보되지 않아 데이터 분실 발생 -> 흐름 제어로 해결

```
(a) 송신        전송 데이터(i)           수신
(b) 수신        다음 데이터 전송 허가      송신
(c) 송신        전송 데이터(i+1)         수신
```
> 실제로는 느려서 사용x, 동시에 여러 개의 전송 데이터를 송신하고 수신 호스트가 데이터 개수 통제

### 데이터 전달 방식
* 단방향 방식(Simplex) : 한 방향으로만 - 일방 통행
* 전이중 방식(Full Duplex) : 양쪽에서 동시에 - 노란 실선 있는 도로
* 반이중 방식(Half Duplex) : 특정 시점에 한 방향으로만 - 무전기

## 3.서비스 프리미티브
* 프리미티브(primitive) : 서비스의 최소 단위
* 하위 계층 -> 상위 계층
* 연결형 서비스(Connection-oriented) : 연결 설정 -> 데이터 전송 -> 연결 해제 / 전화 시스템

|프리미티브|용도|
|CONNECT|연결 설정|
|DATA|데이터 전송|
|DISCONNECT|연결 해제|

* 비연결형 서비스(Connectionless) : 데이터 전송 / 우편 시스템

![image](https://user-images.githubusercontent.com/61977260/194748557-2d99e7a0-e6a8-4d80-b332-76cdba9a1569.png)
> Request -> Indication -> Response -> Confirm

|기능|설명|
|--|--|
|Request|클라이언트가 서버에 서비스를 요청|
|Indication|서버에 서비스 요청이 도착했음을 통지|
|Response|서버가 클라이언트에 서비스 응답을 회신|
|Confirm|클라이언트에 응답이 도착했음을 통지|

# 02. OSI 7계층 모델
## 1. OSI 7계층 모델

![image](https://user-images.githubusercontent.com/61977260/194749233-7a730e2c-2246-4055-a16d-41d7d0da1220.png)

### 용어 정의
* 계층 n 프로토콜 : 계층 n 모듈과 상대 호스트의 계층 n 모듈의 통신 규칙
* 동료 프로세스(Peer Process) : 동일 계층에 위치한 통신 양단(같은 프로토콜을 사용하여 통신하기 때문)
* 인터페이스(interface) : 한 호스트에서 상하로 이웃하는 계층에 위치한 모듈 사이에 존재, 둘 사이의 접근 방법 제한, 상위 계층(서비스 이용) -> 인터페이스 -> 하위 계층(서비스 제공)
* 항상 물리 계층을 통해 데이터 전송

### 헤더 정보
* 계층별로 해당 계층의 헤더 정보를 해석하여 적절히 처리한 후에 상위 계층으로 올림
* 송신 호스트에서 계층별로 추가된 헤더 정보가 수신 호스트에서 해석 및 삭제되어 최상위 수신자는 원래의 전송 데이터만 받음
* 각 계층의 프로토콜은 정해진 기능을 수행하여 데이터 송신 과정에서 발생하는 문제점 해결

### 중계 기능
* 라우팅(Routing) : 경로 배정 기능

![image](https://user-images.githubusercontent.com/61977260/194749505-2cae30eb-43a6-4a69-8871-ad6b2228cb3c.png)
> 라우터의 중계 기능은 3Layer의 기능만 수행

* WAN에서는 교환기(Switch, 라우터x)

## 2. 계층별 기능
### 물리 계층
* 하드웨어 시스템으로 구현되고 전송 매체에서는 개별 정보의 비트 교환 문제를 다룸

### 데이터 링크 계층
* 물리 계층을 통해 전송되는 데이터의 물리적 전송 오류 해결
* 데이터 -> 프레임
* MAC 주소 기록

### 네트워크 계층
* 송신 호스트가 전송한 데이터가 어떤 경로를 통해 수신 호스트에 전달되는지를 결정하는 라우팅 문제 처리
* 데이터 -> 패킷
* IP 주소 기록
* 혼잡 제어 기능

### 전송 계층
* 송신 프로세스 - 수신 프로세스 직접 연결하는 단대단(End to End) 통신 기능 제공
* 프로세스 사이의 통신 문제 다룸
* 전송 오류율, 전송 속도 고려
* 흐름 제어 기능

### 세션 계층
* 전송 계층 + 연결 복구 기능

### 표현 계층
* 통신 양단에서 서로 이해할 수 있는 표준 방식으로 데이터를 코딩하는 문제 다룸
* 데이터 암호화 기능, 압축 기능 제공

### 응용 계층
* 다양한 응용 환경에서 필요한 기능을 다룸

# 03. 인터넷 모델
## 1. 구현 환경
![image](https://user-images.githubusercontent.com/61977260/194749873-ba8283e6-6c0c-4357-bf81-f2cd0c50c9bf.png)
> 사용자 공간 - shell - 시스템 공간(OS kernel)

### 시스템 공간
* TCP와 UDP는 커널(OS) 내부에 구현되므로 일반 사용자 직접 이용x
* 소켓 인터페이스 : 전송 계층의 프리미티브 -> 시스템 콜 기능으로 구현 -> 사용자 프로그램에서 함수 호출 방식으로 사용
* TCP : 연결형 서비스
* UDP : 비연결형 서비스

### 사용자 공간
* 소켓 시스템 콜을 호출해 TCP와 UDP 기능을 사용 가능
* 소켓을 사용할 떄는 소켓마다 부여되는 고유 주소인 포트 번호 관리해야함

## 2. 프로토콜
### 프로토콜 계층 구조
![image](https://user-images.githubusercontent.com/61977260/194750230-a89a4099-86d8-4339-8dc8-eef4ba664dae.png)

* ICMP(Internet Control Message Protocol) : IP의 동작 과정에서 전송 오류가 발생하는 경우에 대비해 오류 정보를 전송하는 목적으로 사용

### ARP와 RARP
* ARP(Address Resolution Protocol) : 수신 호스트의 IP주소를 이용해 MAC 주소를 구하는 기능
* 외부망 연결하기 위해 게이트웨이 접근 -> 그때 게이트웨이 ip주소 아니까 mac주소 구해야함(WAN에서는 ip주소가 아니라 mac주소를 넘기기 때문)

* RARP(Reverse Address Resolution Protocol) : mac주소 -> ip주소

### ICMP
* ICMP(Internet Control Message Protocol) : IP가 동작하는 과정에서 전송 오류 발생 -> 송신자에게 회신해 복구 작업 진행
* 오류 메시지를 전송하기 위한 별도의 헤더 구조 가짐
* IP 패킷(3Layer)에 캡슐화되어 전송, IP(4Layer)와 같은 계층으로 취급
